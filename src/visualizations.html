<!DOCTYPE html>
<html>
<head>
    <!-- <style>
        .observablehq-center {
            align-items: center;
            justify-content: center;
        }

    </style> -->
    <!-- <style>
        /* Style for the card that contains the charts */
        .card {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: flex-start;
          width: 100%;
          height: auto;
          padding: 1rem;
          box-sizing: border-box;
          background: white;
          border-radius: 10px;
          box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Style for chart containers to scale properly */
        .chart-wrapper {
          width: 90%;
          height: auto;
          min-height: 300px; /* Prevents chart from collapsing */
        }

        /* Grid layout for dashboard */
        .grid {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
        }

        /* Ensuring the SVG is responsive */
        .chart-wrapper svg {
          width: 100%;
          height: auto;
        }
      </style> -->

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="generator" content="Observable Framework v1.13.2">
  <title>French + Danish Theater Visualizations | Hello Framework</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
  <link rel="preload" as="style" href="./_observablehq/theme-air,near-midnight.dcdbf18e.css">
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
  <link rel="stylesheet" type="text/css" href="./_observablehq/theme-air,near-midnight.dcdbf18e.css">
  <!-- Include necessary module preloads and scripts -->
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script type="module">
    // Import necessary modules and define your visualizations
    import {define} from "./_observablehq/client.762fe19d.js";
    import {registerFile} from "./_observablehq/stdlib.fc5dbcd7.js";
    import { createBarChart } from "../../src/components/barchart.js";

    const fetchFrenchData = async () => {
      const response = await fetch("https://hack.cfregisters.org/data/json/performances.json");
      return response.json();
    };

    const proxyUrls = [
  "https://api.allorigins.win/get?url=",
  "https://thingproxy.freeboard.io/fetch/",
];

const fetchDutchData = async () => {
  const endpoint = "https://lod.uba.uva.nl/CREATE/ONSTAGE/sparqlShare";
  const query = `
    PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
    PREFIX onstage: <http://lod.uba.uva.nl/CREATE/ONSTAGE/>

    SELECT ?performance ?title ?date
    WHERE {
      ?performance rdf:type onstage:Performance .
      ?performance onstage:title ?title .
      ?performance onstage:date ?date .
    }
    LIMIT 100
  `;

  for (const proxy of proxyUrls) {
    const url = `${proxy}${encodeURIComponent(endpoint)}?query=${encodeURIComponent(query)}&format=json`;

    try {
      const response = await fetch(url);
      if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);

      const result = await response.json();

      // If using allorigins, data is wrapped in 'contents'
      const data = result.contents ? JSON.parse(result.contents) : result;

      return data.results.bindings.map(d => ({
        title: d.title.value,
        performance_date: d.date.value
      }));
    } catch (error) {
      console.warn(`Proxy failed: ${proxy}`, error);
    }
  }

  console.error("All proxy attempts failed.");
  return [];
};


    (async () => {
      const frenchData = await fetchFrenchData();
      const dutchData = await fetchDutchData();

      // Combine both datasets
      const combinedData = [...frenchData, ...dutchData];

      // Update dashboard stats
      document.getElementById("total-performances").textContent = combinedData.length;
      document.getElementById("total-comedies").textContent = combinedData.filter(d => d.genre === "com√©die").length;

      // Create visualization
      const chart = createBarChart(combinedData, { height: 500 });
      document.getElementById("chart-container").appendChild(chart);
    })();



/// days with performances instead of total peformances







    // Add more cell definitions as needed
  </script>
</head>
<body>
  <!-- Sidebar structure -->
  <input id="observablehq-sidebar-toggle" type="checkbox" title="Toggle sidebar">
  <label id="observablehq-sidebar-backdrop" for="observablehq-sidebar-toggle"></label>
  <nav id="observablehq-sidebar">
    <ol>
        <label id="observablehq-sidebar-close" for="observablehq-sidebar-toggle"></label>
        <li class="observablehq-link"><a href="./index.html">Hello Framework</a></li>
      </ol>
      <ol>
        <li class="observablehq-link"><a href="./example-dashboard.html">Example dashboard</a></li>
        <li class="observablehq-link"><a href="./example-report.html">Example report</a></li>
        <li class="observablehq-link"><a href="">French + Dutch Theater Visualizations 1748-1778</a></li>
      </ol>
  </nav>

  <div id="observablehq-center">
    <aside id="observablehq-toc" data-selector="h1:not(:first-of-type)[id], h2:first-child[id], :not(h1) + h2[id]">
      <!-- Add your table of contents here -->
    </aside>
    <main id="observablehq-main" class="observablehq">
      <h1 id="urop-visualizations" tabindex="-1">
        <a class="observablehq-header-anchor" href="#urop-visualizations">French + Dutch Theater Visualizations</a>
      </h1>




      <h2 id="bar-chart" tabindex="-1">
        <a class="observablehq-header-anchor" href="#bar-chart">French Theater</a>
      </h2>

      <div class="grid grid-cols-2">
        <div class="card">
          <h2>Total Performances</h2>
          <span class="big" id="total-performances">Loading...</span>
        </div>
        <div class="card">
          <h2>Total Comedies</h2>
          <span class="big" id="total-comedies">Loading...</span>
        </div>
      </div>

      <div class="observablehq observablehq--block">

        <!-- Your bar chart will be rendered here -->
        <!--:chart:-->
        <div class="grid grid-cols-2 gap-4">
            <div class="card">
              <h2>Performances by Year</h2>
              <div id="chart-container"></div>
            </div>
            <!-- <div class="card">
              <h2>Comedies by Theater</h2>
              <div id="comedy-chart"></div>
            </div> -->
          </div>


      </div>

      <!-- Add more sections for other visualizations -->

    </main>
    <footer id="observablehq-footer">
      <!-- Add your footer content here -->
    </footer>
  </div>
</body>
</html>
